<include file="App/Admin/View/Public/left.html"/>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/Admin/show.css"/>
<script>
    window._deel = {
        req_member_details_url: "{:U('member/member_details')}",
    }
</script>
<script src="__PUBLIC__/Admin/js/member_details.js"></script>
<script src="__PUBLIC__/js/laydate/laydate.js"></script>
<style>
    .list-menu {
        list-style: none;
        display: block;
        margin: 0 0 15px;
    }

    .list-menu li {
        display: inline-block;
    }

    .list-menu li a {
        min-width: 80px;
    }

    .list-menu li + li {
        margin-left: 10px;
    }
    @font-face {
        font-family: 'iconfont';  /* project id 866592 */
        src: url('//at.alicdn.com/t/font_866592_j77i3umh4fi.eot');
        src: url('//at.alicdn.com/t/font_866592_j77i3umh4fi.eot?#iefix') format('embedded-opentype'),
        url('//at.alicdn.com/t/font_866592_j77i3umh4fi.woff') format('woff'),
        url('//at.alicdn.com/t/font_866592_j77i3umh4fi.ttf') format('truetype'),
        url('//at.alicdn.com/t/font_866592_j77i3umh4fi.svg#iconfont') format('svg');
    }
    .iconfont{
        font-family:"iconfont" !important;
        font-size:16px;font-style:normal;
        -webkit-font-smoothing: antialiased;
        -webkit-text-stroke-width: 0.2px;
        -moz-osx-font-smoothing: grayscale;
    }
    .sort{
        color: #333 !important;
    }
    .sort i{
        display: inline-block;
        position: relative;
        width: 12px;
        height: 12px;
        line-height: 14px;
        margin-right: 6px;
        cursor: pointer;
        color: #4e5b85;
    }
    .sort i b{
        position: absolute;
        left: 0;
        top: 6px;
        font-weight: 400;
        font-size: 12px;
        color: #b7bcce;
        margin-left: 5px;
    }
    .sort i b:first-of-type{
        top: -4px;
    }
</style>
<!--/sidebar-->
<div class="main-wrap">

    <div class="crumb-wrap">
        <div class="crumb-list"><i class="icon-font"></i><a href="{:U('Index/index')}">首页</a><span class="crumb-step">&gt;</span><span
                class="crumb-name">每日拨比</span></div>
    </div>
    <div class="search-wrap">
        <div class="search-content">
            <form action="{:U('boss/bouns_total')}" method="get" style="padding: 0 15px;">
                <table class="search-tab">
                    <tr>
                        <th width="70px">时间:</th>
                        <td style="width: 400px;">
                            <input class="common-text" placeholder="开始时间" name="start_time" value="{$where['start_time']}" id="start_laydate" type="text">
                            ~
                            <input class="common-text" placeholder="结束时间" name="end_time" value="{$where['end_time']}" id="end_laydate" type="text">
                        </td>

                        <td><input class="btn btn-primary btn2" value="查询" type="submit"></td>

                    </tr>
                    <tr>
                        <td colspan="12">
                            <p style="color: red">“从2019年1月20日开始每日波比数据统计！</p>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="12">
                            全部数量:{$total_arr['num']}  &nbsp;&nbsp;&nbsp;&nbsp;
                            全部入金总额:{$total_arr['pay_number']}  &nbsp;&nbsp;&nbsp;&nbsp;
                            全部钱包入金:{$total_arr['xrp_num']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部瑞波(金)入金:{$total_arr['xrpj']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部瑞波(钻)入金:{$total_arr['xrpz']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部静态奖金总额:{$total_arr['base_num']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部动态奖金总额:{$total_arr['bouns_num']} &nbsp;&nbsp;&nbsp;&nbsp;

                        </td>
                    </tr>
                    <tr>
                        <td colspan="12">
                            全部基础分红总额:{$total_arr['num1']}  &nbsp;&nbsp;&nbsp;&nbsp;
                            全部增加分红总额:{$total_arr['num2']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部一级分红总额:{$total_arr['num3']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部幸运赠送总额:{$total_arr['num4']} &nbsp;&nbsp;&nbsp;&nbsp;
                            全部推薦獎勵总额:{$total_arr['num5']} &nbsp;&nbsp;&nbsp;&nbsp;

                        </td>
                    </tr>
                    <tr>
                        <td colspan="12">
                            全部社區獎勵总额:{$total_arr['num6']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部平級獎勵总额:{$total_arr['num7']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部管理獎勵总额:{$total_arr['num8']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部全球獎勵总额:{$total_arr['num9']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部创业獎勵总额:{$total_arr['num10']}&nbsp;&nbsp;&nbsp;&nbsp;
                        </td>
                    </tr>
                    <tr>
                        <td colspan="12">
                            全部总拨比:{$total_arr['all_bobi']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部静态拨比:{$total_arr['quiet_bobi']}&nbsp;&nbsp;&nbsp;&nbsp;
                            全部动态拨比:{$total_arr['move_bobi']}&nbsp;&nbsp;&nbsp;&nbsp;

                        </td>
                    </tr>

                </table>
            </form>

        </div>
    </div>
     
    <div class="result-wrap">
        <div class="result-content" style="overflow: scroll;">
            <table class="result-tab" width="2400px;">
                <tr>
                    <th>日期</th>
                    <th>动态奖金拨比</th>
                    <th>幸运赠送拨比</th>
                    <th>静态奖金拨比</th>
                    <!--<th>总奖金拨比</th>-->
                    <th style="color: red"><a class="sort" id="sort_pay_number" href="javascript:;" data-field="pay_number"><span>入金总额</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_xrp_num" href="javascript:;" data-field="xrp_num"><span>钱包入金</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_xrpj" href="javascript:;" data-field="xrpj"><span>瑞波金入金</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_xrpz" href="javascript:;" data-field="xrpz"><span>瑞波钻入金</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_base_num" href="javascript:;" data-field="base_num"><span>静态奖金总额</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <!--<th style="color: red">入金总额</th>-->
                    <!--<th>钱包入金</th>-->
                    <!--<th>瑞波金入金</th>-->
                    <!--<th>瑞波钻入金</th>-->
                    <!--<th style="color: red">静态奖金总额</th>-->
                    <th><a class="sort" id="sort_num1" href="javascript:;" data-field="num1"><span>基础分红</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num2" href="javascript:;" data-field="num2"><span>增加分红</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num3" href="javascript:;" data-field="num3"><span>一级分红</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num4" href="javascript:;" data-field="num4"><span>幸运赠送</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>

                    <!--<th>基础分红总额</th>-->
                    <!--<th>增加分红总额</th>-->
                    <!--<th>一级分红总额</th>-->
                    <!--<th>互助总额</th>-->
                    <!--<th style="color: red">动态奖金总额</th>-->
                    <th style="color: red" ><a class="sort" id="sort_bouns_num" href="javascript:;" data-field="bouns_num"><span>动态奖金总额</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num5" href="javascript:;" data-field="num5"><span>推薦獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num6" href="javascript:;" data-field="num6"><span>社區獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num7" href="javascript:;" data-field="num7"><span>平級獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num8" href="javascript:;" data-field="num8"><span>管理獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <!--<th>推薦獎勵总额</th>-->
                    <!--<th>社區獎勵总额</th>-->
                    <!--<th>平級獎勵总额</th>-->
                    <!--<th>管理獎勵总额</th>-->
                    <th><a class="sort" id="sort_num9" href="javascript:;" data-field="num9"><span>全球獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_num10" href="javascript:;" data-field="num10"><span>创业獎勵</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <th><a class="sort" id="sort_all_bonus" href="javascript:;" data-field="all_bonus"><span>全部奖金总额</span><i><b class="iconfont asc">&#xe601;</b><b class="iconfont desc">&#xe600;</b></i></a></th>
                    <!--<th>全球獎勵总额</th>-->
                    <!--<th>创业獎勵总额</th>-->
                    <!--<th>全部奖金总额</th>-->

                    <th>操作</th>
                </tr>
                <volist name='list' id='vo'>
                    <tr>
                        <td>{$vo['add_time']}</td>
                        <td>{$vo['move_bobbi']}</td>
                        <td>{$vo['num4_bobbi']}</td>
                        <td>{$vo['quiet_bobbi']}</td>
                        <!--<td>{$vo['total_bobbi']}</td>-->
                        <td>{$vo['pay_number']}</td>
                        <td>{$vo['xrp_num']}</td>
                        <td>{$vo['xrpj']}</td>
                        <td>{$vo['xrpz']}</td>
                        <td>{$vo['base_num']}</td>
                        <td>{$vo['num1']}</td>
                        <td>{$vo['num2']}</td>
                        <td>{$vo['num3']}</td>
                        <td>{$vo['num4']}</td>
                        <td>{$vo['bouns_num']}</td>
                        <td>{$vo['num5']}</td>
                        <td>{$vo['num6']}</td>
                        <td>{$vo['num7']}</td>
                        <td>{$vo['num8']}</td>
                        <td>{$vo['num9']}</td>
                        <td>{$vo['num10']}</td>
                        <td>{$vo['all_bonus']}</td>

                        <td><a href="{:U('boss/activationLog',array('status'=>2,'start_time'=>$where['start_time'],'end_time'=>$where['end_time']))}">详情 </a></td>
                    </tr>
                </volist>

            </table>
            <div class="list-page">
                <ul>{$page}</ul>
            </div>
        </div>
    </div>
</div>
<!--/main-->
</div>
</body>
</html>
<script>

    $(function () {
        function loading() {
            layer.load(1, {
                shade: [0.3, '#000'] //0.1透明度的白色背景
            });
        }

        var url = "{:U('',array_merge($where,['order'=>'__order__','order_by'=>'__order_by__']))}";
        var curr_field2  = "{$where.order}";
        var curr_field = "{$where.order}";
        var curr_sort = "{$where.order_by}";

        $('.sort').click(function(){
            var field = $(this).attr('data-field');
            var order_by = '';
            url = url.replace('__order__',field);

            field = field.replace('.','_');
            curr_field = curr_field.replace('.','_');
            if(field==curr_field && curr_sort=='desc'){
                order_by = 'asc';
            } else {
                order_by = 'desc';
            }
            url = url.replace('__order_by__',order_by);
            location.href = url;
        });

        curr_field2 = curr_field2.replace('.','_');
        $('#sort_'+curr_field2+' .'+curr_sort).css('color','#f00');
        laydate({
            elem: '#start_laydate'
        });
        laydate({
            elem: '#end_laydate'
        });
      //全选和反选
        $("#checkAll").click(function () {
            $('input[name="subBox"]').attr("checked", this.checked);
        });

        var $subBox = $("input[name='subBox']");
        $subBox.click(function () {
            $("#checkAll").attr("checked", $subBox.length == $("input[name='subBox']:checked").length ? true : false);
        });
        
        

    	
        $("button.review").on('click', function () {
            var _ = $(this),
                _id = _.parents('tr').attr('data-id'),
                _type = _.attr('data-type'),
                data = {
                    id: _id,
                    type: _type ? _type : 1
                },
                text = data.type == 1 ? "通过" : "不通过";

            layer.confirm("确定" + text + "实名认证吗？", {btn: ['是的','取消']}, function () {
                var loading = layer.msg('服务器君正在用力加载中，请稍等···', {
                    icon: 16
                    , shade: 0.3
                    , time: 0
                    , scrollbar: false
                });

                $.ajax({
                    data: data,
                    type: 'post',
                    dataType: 'json',
                    url: "{:U('member/member_verify')}",
                    success: function (callback) {
                        if(callback.Code == 1){
                            layer.alert(callback.Msg, {icon: 5});
                            setTimeout(function () {
                                window.location.href = window.location.href;
                                window.parent.location.reload();
                                parent.layer.close(mylay);
                            },3000);
                            layer.close(loading);
                        }else{
                            layer.alert(callback.Msg, {icon: 5});
                            layer.close(loading);
                        }
                    },
                    error: function (e) {
                        layer.alert("请求失败", {icon: 5});
                        layer.close(loading);
                    }
                });
            }, function () {
                layer.close();
            });
        });
    });
    
    /**
     * 批量审核
     */
   //禁止按钮重复提交
     var submit_lock = true;

    function review(type) {

        if (!submit_lock) {
            return false;
        }
        submit_lock = false;

        var _subbox_el = $('input[name="subBox"]'),
            _check_list = [], //勾选的申请列表
            data = {}; //模板条件

        _subbox_el.each(function (index, el) {
            if ($(el).is(":checked")) {
                _check_list.push($(el).val());
            }
        });

        if (!_check_list.length > 0) {
            layer.alert("请选择要审核", {'icon': 5});
            submit_lock = true;
            return false;
        }
        //console.info(_check_list);

        
        layer.confirm("确认批量审核吗？", {icon: 3, title: '批量审核确认'}, function (index) {
            layer.msg('提交审核中，请稍等···', {
                icon: 16
                , shade: 0.3
                , time: 0
                , scrollbar: false
            });

            $.ajax({
                type: 'post',
                dataType: 'json',
                data: {list: _check_list,type:type},
                url: "{:U('review')}",
                success: function (callback) {
                    if (callback.Code == 1) {
                        layer.alert(callback.Msg, {"icon": 6});
                    } else {
                        layer.alert(callback.Msg, {"icon": 5});
                    }
                    setInterval(function () {
                        window.location.href = window.location.href;
                    }, 1500);

                    submit_lock = true;
                },
                error: function (e) {
                    layer.alert("审核失败，请求出错！", {"icon": 5});

                    submit_lock = true;
                }
            });
        });

        submit_lock = true;
        return false;
    }
</script>